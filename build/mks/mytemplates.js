define(["text!html/mytemplates.html"],function(a){return Backbone.View.extend({id:"my_templates",className:"template-gallry",events:{},initialize:function(){this.template=_.template(a);this.render()},render:function(){this.total_count=0;this.$el.html(this.template({}));this.app=this.options.app;if(this.options.params&&this.options.params.action){this.action=this.options.params.action}},init:function(){this.current_ws=this.$el.parents(".ws-content");this.current_ws.find("#campaign_tags").hide();this.addNewTemplateBtn=this.current_ws.find(".camp_header #addnew_action");this.addNewTemplateBtn.attr("data-original-title","New Template");this.app.showLoading("Loading Templates...",this.$el);var b=this;require(["bmstemplates/templates"],function(d){var c=new d({page:b,app:b.app,selectAction:"Create Campaign",hideCreateButton:true,selectTextClass:"createcamp",selectCallback:_.bind(b.createCampaign,b)});c.on("updatecount",_.bind(b.addCountHeader,b));b.$el.html(c.$el);c.init();b.addNewTemplateBtn.click(_.bind(c.createTemplate,c));if(b.action){c.createTemplate();$("#create-template-container .loading").remove()}})},addCountHeader:function(){this.ws_header=this.current_ws.find(".camp_header .edited");var c='<ul class="c-current-status">';c+='<li><span class="badge pclr18 tcount">'+this.total_count+"</span>Total Templates</li>";c+="</ul>";var b=$(c);this.ws_header.append(b)},createCampaign:function(f){var c=$.getObj(f,"a").attr("id").split("_")[1];var d=this;var e="New Campaign";var b=this.app.showDialog({title:e,css:{width:"650px","margin-left":"-325px"},bodyCss:{"min-height":"100px"},buttons:{saveBtn:{text:"Create Campaign"}}});this.app.showLoading("Loading...",b.getBody());require(["newcampaign"],function(g){var h=new g({camp:d,app:d.app,newcampdialog:b,templateID:c});b.getBody().html(h.$el);b.saveCallBack(_.bind(h.createCampaign,h,c))})}})});