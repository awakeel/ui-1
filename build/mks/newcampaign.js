define(["text!html/newcampaign.html"],function(a){return Backbone.View.extend({events:{"keyup #camp_name":function(b){if(b.keyCode==13){this.createCampaign()}}},initialize:function(){this.template=_.template(a);this.render();var b=this.options.newcampdialog;var c=this.options.app;if(this.options.templateID){this.templateID=this.options.templateID}c.showLoading(false,b.getBody())},render:function(){this.app=this.options.app;this.curview=this;this.$el.html(this.template({}))},createCampaign:function(i){var g=this;var b=g.options.camp;var c=g.$el;var d=g.app;var f=g.app.messages[0];var e=g.options.newcampdialog;if(c.find("#camp_name").val()==""){d.showError({control:c.find(".campname-container"),message:f.CAMPS_campname_empty_error})}else{d.hideError({control:c.find(".campname-container")});d.showLoading("Creating campaign...",g.$el);var j="/pms/io/campaign/saveCampaignData/?BMS_REQ_TK="+this.app.get("bms_token");var h={type:"create",campName:c.find("#camp_name").val()};if(this.templateID){h.templateNumber=this.templateID}$.post(j,h).done(function(m){d.showLoading(false,g.$el);var l=jQuery.parseJSON(m);if(l[0]!=="err"){var k=l[1];e.hide();d.mainContainer.openCampaign(k)}else{d.showAlert(l[1],g.$el)}})}}})});